import pika
import os
import time
import psycopg2
from trap_processor 

BATCH_SIZE = 200
BATCH_TIMEOUT = 0.2
PREFETCH_COUNT = 400



# these will need to be defined as such in the rabbitmq yaml before deployment. In the env section.
RABBIT_HOST = None
RABBIT_PORT = None
RABBIT_USER = None
RABBIT_PASS = None


# establish rabbitmq connection
def connect_to_rabbitmq():
    credentials = pika.PlainCredentials(RABBIT_PASS, RABBIT_USER)
    parameters = pika.ConnectionParameters(host=RABBIT_HOST, port=RABBIT_PORT, credentials=credentials)
    rabbit_conn = pika.BlockingConnection(parameters)
    channel = rabbit_conn.channel
    channel.basic_qos(prefetch_count=PREFETCH_COUNT)
    return channel


# define db variables
DB_HOST = None
DB_PORT = None
DB_NAME = None
DB_USER = None
DB_PASS = None

# establish db connection
def connect_to_db():
    db_conn = psycopg2.connect(
        host = DB_HOST,
        port = DB_PORT,
        database = DB_NAME,
        user = DB_USER,
        password = DB_PASS

    )

    return db_conn






